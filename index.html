<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Workflow Action Planner</title>
  <style>
    body { font-family: Arial; max-width: 800px; margin: auto; padding: 20px; }
    textarea { width: 100%; height: 100px; }
    button { padding: 10px 15px; font-size: 16px; margin-top: 10px; }
    pre { background: #f4f4f4; padding: 10px; overflow-x: auto; }
  </style>
</head>
<body>
<h1>Workflow Action Planner</h1>

<textarea id="input" placeholder="Describe your workflow pain point..."></textarea>
<br><br>
<button onclick="generate()">Generate Action Plan</button>

<h2>Human-Readable Plan</h2>
<div id="human"></div>

<h2>Raw JSON</h2>
<pre id="json"></pre>

<script>
async function generate() {
    const pain_point = document.getElementById("input").value;

    // Updated to fetch from the /api proxy configured in netlify.toml
    const res = await fetch("/api/generate-plan", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ pain_point })
    });

    const data = await res.json();

    document.getElementById("human").innerHTML =
        `<p><b>Problem Statement:</b> ${data.problem_statement}</p>` +
        `<p><b>Clarifying Questions:</b><br>${data.clarifying_questions.join("<br>")}</p>` +
        `<p><b>Proposed Approach:</b><br>${data.proposed_approach.join("<br>")}</p>` +
        `<p><b>Recommended Tools:</b><br>${data.recommended_tools.join("<br>")}</p>` +
        `<p><b>Risks & Privacy:</b><br>${data.risks_and_privacy.join("<br>")}</p>` +
        `<p><b>Next Steps:</b><br>${data.next_steps.join("<br>")}</p>`;

    document.getElementById("json").textContent = JSON.stringify(data, null, 2);
}
</script>
</body>
</html>